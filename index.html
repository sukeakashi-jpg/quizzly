<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Quizly â€” Pregunta del DÃ­a</title>

<!-- Fuentes -->
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
  :root{
    --navy:#0b1c33;
    --navy-light:#162c4a;
    --beige:#f7f3e9;
    --beige-soft:#f3eee3;
    --white:#ffffff;
    --accent:#4f8cc9;
    --muted:#b5b5b5;
    --anim: .9s;
  }
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{
    height:100%;
    background:linear-gradient(135deg,var(--navy),var(--navy-light));
    font-family:"Poppins",system-ui,Arial;
    color:var(--beige);
    -webkit-font-smoothing:antialiased;
  }

  /* Logo */
  .top-logo{
    position:relative;
    width:140px;
    margin:22px auto 10px auto;
    z-index:50;
  }
  .top-logo img{
    width:100%;
    display:block;
    border-radius:12px;
    box-shadow:0 6px 18px rgba(0,0,0,0.5);
  }

  /* Contenedor */
  .wrap{
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    padding:12px;
  }
  .app{
    width:90%;
    max-width:370px;
    background:linear-gradient(180deg,var(--navy-light),#12284d);
    border-radius:18px;
    padding:16px;
    box-shadow:0 20px 50px rgba(0,0,0,0.45);
    border:1px solid rgba(255,255,255,0.1);
    animation:fadeIn var(--anim) ease forwards;
    opacity:0;
    transform:translateY(8px);
  }
  @keyframes fadeIn{to{opacity:1;transform:translateY(0)}}

  header{
    display:flex;
    justify-content:space-between;
    align-items:center;
  }
  h1.title{
    font-family:"Playfair Display",serif;
    font-size:22px;
    color:var(--beige);
    margin-bottom:2px;
  }
  p.lead{font-size:12px;color:var(--muted)}

  main{margin-top:12px;display:flex;flex-direction:column;gap:12px}

  .screen{
    display:none;
    opacity:0;
    transform:scale(.98) translateY(8px);
    transition:opacity var(--anim) ease,transform var(--anim) ease;
  }
  .screen.active{
    display:block;
    opacity:1;
    transform:scale(1) translateY(0);
  }

  /* Inputs y botones */
  input[type="text"]{
    width:100%;
    padding:10px;
    border-radius:10px;
    border:none;
    outline:none;
    background:var(--beige-soft);
    color:#222;
    font-size:14px;
  }

  .btn{
    background:var(--accent);
    border:none;
    color:var(--white);
    padding:10px;
    border-radius:10px;
    cursor:pointer;
    font-weight:600;
    transition:all .3s ease;
  }
  .btn:hover{background:#3c74a8}
  .btn.ghost{
    background:transparent;
    border:2px solid rgba(255,255,255,0.15);
    color:var(--muted);
  }
  .btn.ghost:hover{color:var(--beige);border-color:var(--accent)}

  .center{display:flex;flex-direction:column;align-items:center;gap:10px;text-align:center}

  /* Topics */
  .topics{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:10px;
  }
  .topic{
    background:var(--navy-light);
    border:2px solid rgba(255,255,255,0.1);
    padding:10px;
    border-radius:10px;
    text-align:center;
    font-weight:600;
    cursor:pointer;
    transition:transform .3s ease, background .3s ease;
  }
  .topic:hover{background:#1e3a68;transform:translateY(-3px)}
  .topic.selected{border-color:var(--accent);box-shadow:0 0 10px rgba(79,140,201,0.4)}

  /* Quiz */
  .card{
    background:var(--navy-light);
    border-radius:12px;
    padding:10px;
    box-shadow:0 8px 20px rgba(0,0,0,0.4);
  }
  .question{font-family:"Playfair Display",serif;font-size:17px;margin-bottom:8px;color:var(--beige)}
  .meta{font-size:12px;color:var(--muted);margin-bottom:8px}
  .option{
    background:var(--navy);
    border:2px solid rgba(255,255,255,0.1);
    border-radius:10px;
    padding:10px;
    cursor:pointer;
    font-weight:600;
    color:var(--beige);
    transition:all .3s ease;
  }
  .option:hover{background:#1d3b66;transform:translateY(-3px)}
  .option.disabled{opacity:0.5;pointer-events:none}
  .option.correct{background:linear-gradient(90deg,#1b5231,#2d8f4b);border-color:#54da8b}
  .option.wrong{background:linear-gradient(90deg,#522525,#8a3535);border-color:#e57373}

  .status{font-size:13px;color:var(--muted);margin-top:8px}

  /* Result */
  .result-title{font-family:"Playfair Display",serif;font-size:18px;color:var(--beige)}
  .result-msg{font-size:14px;margin:10px 0 14px 0;color:var(--muted)}

  /* History */
  .history{display:flex;flex-direction:column;gap:8px}
  .hist-item{
    display:flex;justify-content:space-between;
    padding:8px;
    border-radius:10px;
    background:var(--navy-light);
    border:1px solid rgba(255,255,255,0.08);
    font-size:13px;
    color:var(--beige);
  }

  footer{text-align:center;font-size:12px;color:var(--muted);margin-top:10px}

  /* Splash */
  #splash{
    position:fixed;left:0;top:0;width:100%;height:100%;
    display:flex;align-items:center;justify-content:center;
    background:var(--navy);
    z-index:9999;
  }
  #splash img{
    width:160px;
    animation:popIn 1.2s ease both;
  }
  @keyframes popIn{
    0%{transform:scale(.6);opacity:0}
    60%{transform:scale(1.05);opacity:1}
    100%{transform:scale(1)}
  }

  @media (max-width:420px){
    .app{width:92%;padding:14px}
    .top-logo{width:120px}
  }
</style>
</head>
<body>

<!-- Splash -->
<div id="splash"><img src="img/logo.png" alt="Quizly logo"></div>

<!-- Logo -->
<div class="top-logo"><img src="img/logo.png" alt="Logo Quizly"></div>

<!-- Contenedor principal -->
<div class="wrap">
  <div class="app" role="application">
    <header>
      <div>
        <h1 class="title">Quizly</h1>
        <p class="lead">Pregunta del dÃ­a</p>
      </div>
      <div id="userShort" style="font-weight:700;color:var(--accent)"></div>
    </header>

    <main>
      <!-- LOGIN -->
      <section id="screen-login" class="screen active">
        <div class="center">
          <h2 style="font-family:'Playfair Display',serif;color:var(--beige)">Bienvenido</h2>
          <p class="meta">Ingresa tu nombre para comenzar</p>
          <input id="inputName" type="text" placeholder="Tu nombre (ej. Judson)">
          <div style="display:flex;gap:8px;width:100%">
            <button id="btnStart" class="btn" style="flex:1">Comenzar</button>
            <button id="btnGuest" class="btn ghost" style="flex:1">Invitado</button>
          </div>
        </div>
      </section>

      <!-- TOPICS -->
      <section id="screen-topics" class="screen">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <h3 style="font-family:'Playfair Display',serif;color:var(--beige)">Elige un tema</h3>
            <p class="meta">Selecciona la categorÃ­a</p>
          </div>
          <button id="btnLogout" class="btn ghost">Cerrar</button>
        </div>
        <div style="height:10px"></div>
        <div id="topics" class="topics"></div>
        <div style="display:flex;gap:8px;margin-top:12px">
          <button id="btnOpenQuiz" class="btn" style="flex:1">Ver pregunta</button>
          <button id="btnHistory" class="btn ghost" style="flex:1">Historial</button>
        </div>
      </section>

      <!-- QUIZ -->
      <section id="screen-quiz" class="screen">
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:flex-start">
            <div>
              <div id="questionText" class="question">â€”</div>
              <div id="metaInfo" class="meta">Tema â€¢ Pregunta del dÃ­a</div>
            </div>
            <button id="btnChangeTopic" class="btn ghost" style="min-width:80px">Cambiar</button>
          </div>
          <div style="height:10px"></div>
          <div id="options" class="options" role="list"></div>
          <div id="statusText" class="status"></div>
        </div>
      </section>

      <!-- RESULT -->
      <section id="screen-result" class="screen">
        <div style="text-align:center;padding:8px">
          <div id="resultTitle" class="result-title">â€”</div>
          <div id="resultMsg" class="result-msg">â€”</div>
          <button id="btnBackHome" class="btn">Volver al inicio</button>
          <div style="height:8px"></div>
          <button id="btnLogout2" class="btn ghost">Cerrar sesiÃ³n</button>
        </div>
      </section>

      <!-- HISTORY -->
      <section id="screen-history" class="screen">
        <div>
          <h3 style="font-family:'Playfair Display',serif;color:var(--beige)">Historial</h3>
          <p class="meta">Tus respuestas anteriores</p>
        </div>
        <div style="height:8px"></div>
        <div id="historyList" class="history"></div>
        <div style="display:flex;gap:8px;margin-top:10px">
          <button id="btnBackToTopics" class="btn ghost" style="flex:1">Volver</button>
          <button id="btnClearHistory" class="btn" style="flex:1">Borrar historial</button>
        </div>
      </section>
    </main>

    <footer>Colegio Agropecuario de San Carlos â€” DiseÃ±o de Software â€” 2025</footer>
  </div>
</div>

<script>
  const BANK={
    'Ciencia':[{q:'Â¿CuÃ¡l es la unidad bÃ¡sica de la vida?',opts:['Ãtomo','CÃ©lula','MolÃ©cula','Ã“rgano'],a:1},
      {q:'Â¿QuÃ© gas respiramos principalmente?',opts:['NitrÃ³geno','OxÃ­geno','HidrÃ³geno','DiÃ³xido de carbono'],a:1}],
    'Historia':[{q:'Â¿En quÃ© aÃ±o llegÃ³ ColÃ³n a AmÃ©rica?',opts:['1492','1502','1592','1392'],a:0}],
    'MatemÃ¡ticas':[{q:'Â¿CuÃ¡nto es 12 Ã— 8?',opts:['96','86','104','88'],a:0}],
    'Cultura General':[{q:'Â¿CuÃ¡l es la capital de Costa Rica?',opts:['San JosÃ©','Alajuela','Heredia','Cartago'],a:0}]
  };

  const $=id=>document.getElementById(id);
  const todayKey=()=>{const d=new Date();return `${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;}
  function loadState(){return JSON.parse(localStorage.getItem('quizly_app')||'{}');}
  function saveState(s){localStorage.setItem('quizly_app',JSON.stringify(s));}
  let state=loadState();
  if(!state.users)state.users={};
  if(!state.current)state.current={name:null,topic:null};

  const screens=document.querySelectorAll('.screen');
  const screenLogin=$('screen-login'),screenTopics=$('screen-topics'),screenQuiz=$('screen-quiz'),screenResult=$('screen-result'),screenHistory=$('screen-history');
  const inputName=$('inputName'),userShort=$('userShort');
  const topicsDiv=$('topics'),btnOpenQuiz=$('btnOpenQuiz'),btnHistory=$('btnHistory'),btnLogout=$('btnLogout');
  const questionText=$('questionText'),metaInfo=$('metaInfo'),optionsDiv=$('options'),statusText=$('statusText');
  const btnBackHome=$('btnBackHome'),btnLogout2=$('btnLogout2');
  const historyList=$('historyList'),btnBackToTopics=$('btnBackToTopics'),btnClearHistory=$('btnClearHistory');

  function showScreen(el){screens.forEach(s=>s.classList.remove('active'));el.classList.add('active');}
  setTimeout(()=>{$('splash').style.display='none';},2000);

  const TOPICS=Object.keys(BANK);
  function renderTopics(){
    topicsDiv.innerHTML='';
    TOPICS.forEach(t=>{
      const d=document.createElement('div');
      d.className='topic';
      d.textContent=t;
      if(state.current.topic===t)d.classList.add('selected');
      d.onclick=()=>{state.current.topic=t;saveState(state);renderTopics();};
      topicsDiv.appendChild(d);
    });
  }

  $('btnStart').onclick=()=>{const n=inputName.value.trim();if(!n)return alert('Escribe tu nombre');loginAs(n);}
  $('btnGuest').onclick=()=>loginAs('Invitado');
  btnLogout.onclick=()=>logout();btnLogout2.onclick=()=>logout();

  function loginAs(name){
    state.current.name=name;
    if(!state.users[name])state.users[name]={history:[],lastAnswered:''};
    saveState(state);
    renderApp();showScreen(screenTopics);
  }
  function logout(){
    if(confirm('Â¿Cerrar sesiÃ³n?')){
      state.current={name:null,topic:null};saveState(state);
      renderApp();showScreen(screenLogin);
    }
  }

  function renderApp(){
    userShort.textContent=state.current.name||'';
    renderTopics();
    if(state.current.name)showScreen(screenTopics);
    else showScreen(screenLogin);
  }

  btnOpenQuiz.onclick=()=>{
    if(!state.current.topic)return alert('Selecciona un tema');
    showQuiz();
  };
  btnHistory.onclick=()=>showHistory();
  btnBackToTopics.onclick=()=>showScreen(screenTopics);
  btnClearHistory.onclick=()=>{
    if(confirm('Â¿Borrar historial?')){
      state.users[state.current.name].history=[];
      saveState(state);renderHistory();
    }
  };

  function showQuiz(){
    const topic=state.current.topic;
    const q=BANK[topic][0];
    questionText.textContent=q.q;
    metaInfo.textContent=`${topic} â€¢ Pregunta del dÃ­a`;
    optionsDiv.innerHTML='';
    q.opts.forEach((opt,i)=>{
      const b=document.createElement('div');
      b.className='option';b.textContent=opt;
      b.onclick=()=>selectAnswer(i,q);
      optionsDiv.appendChild(b);
    });
    showScreen(screenQuiz);
  }

  function selectAnswer(i,q){
    const correct=i===q.a;
    document.querySelectorAll('.option').forEach((el,idx)=>{
      el.classList.add('disabled');
      if(idx===q.a)el.classList.add('correct');
      else if(idx===i)el.classList.add('wrong');
    });
    const record={date:todayKey(),topic:state.current.topic,question:q.q,chosen:i,answer:q.a,correct};
    state.users[state.current.name].history.push(record);
    saveState(state);
    setTimeout(()=>showResultScreen(correct,state.current.topic,q.q),700);
  }

  function showResultScreen(correct,topic,question){
    const name=state.current.name||'Amigo';
    $('resultTitle').textContent=correct?`Â¡Correcto, ${name}! ðŸŽ‰`:`No fue esta vez, ${name}. âŒ`;
    $('resultMsg').textContent=correct?`Respondiste bien la pregunta de ${topic}.`:`Fallaste la pregunta de ${topic}, vuelve maÃ±ana.`;
    showScreen(screenResult);
  }

  btnBackHome.onclick=()=>showScreen(screenTopics);

  function showHistory(){renderHistory();showScreen(screenHistory);}
  function renderHistory(){
    const hist=(state
